var Vector=function(t,i){"undefined"===t&&(t=0),"undefined"===i&&(i=0),this.x=t,this.y=i};Vector.prototype.add=function(t){return new Vector(this.x+t.x,this.y+t.y)},Vector.prototype.sub=function(t){return new Vector(this.x-t.x,this.y-t.y)},Vector.prototype.mul=function(t){return new Vector(this.x*t.x,this.y*t.y)},Vector.prototype.div=function(t){return new Vector(this.x/t.x,this.y/t.y)},Vector.prototype.mag=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},Vector.prototype.normalise=function(t){var i=this.mag();return new Vector(this.x/i,this.y/i)},Vector.prototype.dist=function(t){return Math.sqrt((this.x-t.x)*(this.x-t.x)+(this.y-t.y)*(this.y-t.y))},Vector.prototype.limit=function(t){return this.mag()>t?this.normalise().mul(new Vector(t,t)):this};var Boid=function(t,i,s,e,o,n,a){if(this.position=new Vector(i.x,i.y),this.velocity=new Vector(s.x,s.y),this.acceleration=new Vector(0,0),!/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(o))return console.error("Please specify a valid boid hexadecimal color"),!1;this.size=e,this.colour=o,this.parent=t,this.actualSize=this.size*this.parent.boidRadius,this.tickCount=0,this.ticksPerFrame=2,this.numberOfFrames=9,this.imageWidth=900,this.imageHeight=100,this.frameIndex=Math.floor(Math.random()*(this.numberOfFrames+1)),this.image=n,this.imageFlipped=a};Boid.prototype.draw=function(){var t;t=this.velocity.x>=0?this.image:this.imageFlipped,this.parent.ctx.drawImage(t,this.frameIndex*this.imageWidth/this.numberOfFrames,0,this.imageWidth/this.numberOfFrames,this.imageHeight,this.position.x,this.position.y,this.actualSize,this.actualSize)},Boid.prototype.update=function(){if(this.parent.move){var t=this.cohesion(),i=this.separation(),s=this.alignment(),e=this.interactivity();t=t.mul(new Vector(.5,.5)),i=i.mul(new Vector(2,2)),s=s.mul(new Vector(1,1)),e=e.mul(new Vector(2.2,2.2)),this.applyForce(t),this.applyForce(i),this.applyForce(s),this.applyForce(e),this.velocity=this.velocity.add(this.acceleration),this.velocity=this.velocity.limit(this.parent.options.speed),this.position=this.position.add(this.velocity),this.acceleration=this.acceleration.mul(new Vector(0,0)),this.borders()}this.tickCount+=1,this.tickCount>this.ticksPerFrame&&(this.tickCount=0,this.frameIndex<this.numberOfFrames-1?this.frameIndex+=1:this.frameIndex=0)},Boid.prototype.cohesion=function(){for(var t=new Vector(0,0),i=0,s=0;s<this.parent.boids.length;s++){var e=this.position.dist(this.parent.boids[s].position);e>0&&e<this.parent.visibleRadius&&(t=t.add(this.parent.boids[s].position),i++)}return i>0?(t=t.div(new Vector(i,i)),t=this.seek(t)):new Vector(0,0)},Boid.prototype.separation=function(){for(var t=new Vector(0,0),i=0,s=0;s<this.parent.boids.length;s++){var e=this.position.dist(this.parent.boids[s].position)-this.size*this.parent.boidRadius;if(e>0&&e<this.parent.separationDist){var o=this.position.sub(this.parent.boids[s].position);o=o.normalise(),o=o.div(new Vector(e,e)),t=t.add(o),i++}}return i>0&&(t=t.div(new Vector(i,i))),t.mag()>0&&(t=t.normalise(),t=t.mul(new Vector(this.parent.options.speed,this.parent.options.speed)),t=t.sub(this.velocity),t=t.limit(this.parent.maxForce)),t},Boid.prototype.alignment=function(){for(var t=new Vector(0,0),i=0,s=0;s<this.parent.boids.length;s++){var e=this.position.dist(this.parent.boids[s].position);e>0&&e<this.parent.visibleRadius&&(t=t.add(this.parent.boids[s].velocity),i++)}if(i>0){t=t.div(new Vector(i,i)),t=t.normalise(),t=t.mul(new Vector(this.parent.options.speed,this.parent.options.speed));var o=t.sub(this.velocity);return o=o.limit(this.parent.maxForce)}return new Vector(0,0)},Boid.prototype.interactivity=function(){return this.parent.options.interactive&&void 0!==this.parent.mousePos&&this.position.dist(this.parent.mousePos)<this.parent.visibleRadius?this.seek(this.parent.mousePos):new Vector(0,0)},Boid.prototype.borders=function(){this.position.x+this.actualSize<0&&(this.position.x=this.parent.canvas.width),this.position.y+this.actualSize<0&&(this.position.y=this.parent.canvas.height),this.position.x>this.parent.canvas.width&&(this.position.x=0),this.position.y>this.parent.canvas.height&&(this.position.y=0)},Boid.prototype.seek=function(t){var i=t.sub(this.position);i=i.normalise(),i=i.mul(new Vector(this.parent.options.speed,this.parent.options.speed));var s=i.sub(this.velocity);return s=s.limit(this.parent.maxForce)},Boid.prototype.applyForce=function(t){this.acceleration=this.acceleration.add(t.div(new Vector(this.size,this.size)))};var BoidsCanvas=function(t,i){this.canvasDiv=t,this.canvasDiv.size={width:this.canvasDiv.offsetWidth,height:this.canvasDiv.offsetHeight},i=void 0!==i?i:{},this.options={background:void 0!==i.background?i.background:"#1a252f",density:this.setDensity(i.density),speed:this.setSpeed(i.speed),interactive:void 0===i.interactive||i.interactive,mixedSizes:void 0===i.mixedSizes||i.mixedSizes,boidColours:void 0!==i.boidColours&&0!==i.boidColours.length?i.boidColours:["#ff3333"]},this.visibleRadius=600,this.maxForce=.05,this.separationDist=200,this.boidRadius=30,this.move=!1,this.init()};BoidsCanvas.prototype.init=function(){if(this.bgDiv=document.createElement("div"),this.canvasDiv.appendChild(this.bgDiv),this.setStyles(this.bgDiv,{position:"absolute",top:0,left:0,bottom:0,right:0,"z-index":1}),/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(this.options.background))this.setStyles(this.bgDiv,{background:this.options.background});else{if(!/\.(gif|jpg|jpeg|tiff|png)$/i.test(this.options.background))return console.error("Please specify a valid background image or hexadecimal color"),!1;this.setStyles(this.bgDiv,{background:'url("'+this.options.background+'") no-repeat center',"background-size":"cover"})}this.canvas=document.createElement("canvas"),this.canvasDiv.appendChild(this.canvas),this.ctx=this.canvas.getContext("2d"),this.canvas.width=this.canvasDiv.size.width,this.canvas.height=this.canvasDiv.size.height,this.setStyles(this.canvasDiv,{position:"relative"}),this.setStyles(this.canvas,{"z-index":"20",position:"relative"}),window.addEventListener("resize",function(){if(this.canvasDiv.offsetWidth===this.canvasDiv.size.width&&this.canvasDiv.offsetHeight===this.canvasDiv.size.height)return!1;this.canvas.width=this.canvasDiv.size.width=this.canvasDiv.offsetWidth,this.canvas.height=this.canvasDiv.size.height=this.canvasDiv.offsetHeight,this.initialiseBoids()}.bind(this)),this.initialiseBoids(),this.canvas.addEventListener("mousemove",function(t){this.mousePos=new Vector(t.clientX-this.canvas.offsetLeft,t.clientY-this.canvas.offsetTop)}.bind(this)),this.canvas.addEventListener("mouseleave",function(t){this.mousePos=void 0}.bind(this)),this.canvasDiv.onclick=function(){this.move=!this.move}.bind(this),requestAnimationFrame(this.update.bind(this))},BoidsCanvas.prototype.initialiseBoids=function(){this.boids=[];for(var t=this.canvas.width,i=this.canvas.height,s=0;s<this.canvas.width*this.canvas.height/this.options.density;s++){for(var e=new Vector(Math.floor(Math.random()*(this.canvas.width+1)),Math.floor(Math.random()*(this.canvas.height+1)));!function(s){return.35*t<=s.x&&s.x<=.45*t&&.2*i<=s.y&&s.y<=.8*i||.45*t<=s.x&&s.x<=.65*t&&.6*i<=s.y&&s.y<=.8*i}(e);)e=new Vector(Math.floor(Math.random()*(this.canvas.width+1)),Math.floor(Math.random()*(this.canvas.height+1)));var o=new Vector(Math.floor(1.2*Math.random()-.1),Math.floor(1.2*Math.random()-.1)),n=this.options.mixedSizes?Math.floor(3*Math.random()+1):1,a=Math.floor(Math.random()*(this.options.boidColours.length-1+1)),h=new Image;h.src="/boid-sprite.png";var r=new Image;r.src="/boid-sprite-flipped.png",this.boids.push(new Boid(this,e,o,n,this.options.boidColours[a],h,r))}},BoidsCanvas.prototype.update=function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.globalAlpha=1;for(var t=0;t<this.boids.length;t++)this.boids[t].update(),this.boids[t].draw();requestAnimationFrame(this.update.bind(this))},BoidsCanvas.prototype.setSpeed=function(t){return"fast"===t?5:"slow"===t?1:3},BoidsCanvas.prototype.setDensity=function(t){return"high"===t?5e3:"low"===t?2e4:1e4},BoidsCanvas.prototype.setStyles=function(t,i){for(var s in i)t.style[s]=i[s]};